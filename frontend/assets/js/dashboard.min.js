const ctx=document.getElementById("networkChart").getContext("2d"),networkChart=new Chart(ctx,{type:"line",data:{labels:Array(30).fill(""),datasets:[{label:"In (Mb/s)",data:Array(30).fill(0),borderColor:"rgba(0, 123, 255, 0.8)",backgroundColor:"rgba(0, 123, 255, 0.1)",borderWidth:2,pointRadius:0,tension:.4,fill:!0},{label:"Out (Mb/s)",data:Array(30).fill(0),borderColor:"rgba(40, 167, 69, 0.8)",backgroundColor:"rgba(40, 167, 69, 0.1)",borderWidth:2,pointRadius:0,tension:.4,fill:!0},]},options:{maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{font:{size:10}}},x:{ticks:{display:!1}}},plugins:{legend:{display:!1}},animation:{duration:250}}}),protocol="https:"===window.location.protocol?"wss:":"ws:",socket=new WebSocket(`${protocol}//${window.location.host}/ws`);socket.onmessage=function(t){let e=JSON.parse(t.data);function a(t,e){let a=document.querySelector(t);a&&(a.textContent=e)}function s(t,e){let a=document.querySelector(t);a&&(a.style.width=e)}a("#cpu-usage",e.cpu.usage),a("#cpu-temp",e.cpu.temp);let c=document.querySelector("#cpu-progress-bar");c&&(c.style.width=e.cpu.usage),a("#ram-usage-gb",`${e.ram.used} / ${e.ram.total}`),a("#ram-usage-percent",`(${e.ram.percent})`),s("#ram-progress-bar",e.ram.percent),a("#docker-containers",e.docker.containers),a("#docker-images",e.docker.images),a("#docker-volumes",e.docker.volumes),a("#streaming-card .library-stat:nth-child(1) .count",e.streaming.films),a("#streaming-card .library-stat:nth-child(2) .count",e.streaming.series),a("#streaming-card .library-stat:nth-child(3) .count",e.streaming.animes);let i=document.querySelector(".streaming-activity .activity-stat:nth-child(1)");i&&(i.innerHTML=`<i class="fas fa-play-circle"></i> ${e.streaming.playing} Media currently playing`);let r=document.querySelector(".streaming-activity .activity-stat:nth-child(2)");r&&(r.innerHTML=`<i class="fas fa-cogs"></i> ${e.streaming.transcoding} Active transcoding`);let n=document.querySelector(".cache-chart .chart-circle");if(n&&n.setAttribute("stroke-dasharray",`${e.arcCache.arcHitRateNum}, 100`),a(".cache-chart .chart-text",e.arcCache.arcHitRate),a(".cache-details .cache-stat:nth-child(1) .stat-value",e.arcCache.arcSize),a(".cache-details .cache-stat:nth-child(2) .stat-value",e.arcCache.arcMaxSize),a(".cache-details .cache-stat:nth-child(4) .stat-value",e.arcCache.l2arcSize),a(".cache-details .cache-stat:nth-child(5) .stat-value",e.arcCache.l2arcHitRate),a(".sysinfo-list li:nth-child(1) span:last-child",e.system.os),a(".sysinfo-list li:nth-child(2) span:last-child",e.system.kernel),a(".sysinfo-list li:nth-child(3) span:last-child",e.system.cpu),e.zfsConfig&&e.zfsConfig.poolName){a("#zfs-card .pool-name",e.zfsConfig.poolName);let l=document.querySelector("#zfs-card .pool-status");l&&(l.textContent=e.zfsConfig.poolStatus,l.className="pool-status "+e.zfsConfig.poolStatus.toLowerCase());let o=document.querySelector("#zfs-card .zfs-column:nth-child(1) .zfs-tree"),d=document.querySelector("#zfs-card .zfs-column:nth-child(2) .zfs-tree");if(o&&d&&(o.innerHTML="",d.innerHTML="",e.zfsConfig.dataVdevs.forEach(t=>{let e=document.createElement("li"),a="<ul>";t.devices.forEach(t=>{a+=`<li><i class="fas fa-hdd"></i> ${t}</li>`}),a+="</ul>",e.innerHTML=`<i class="fas fa-layer-group"></i> ${t.name} <span class="device-status">${t.status}</span>${a}`,o.appendChild(e)}),e.zfsConfig.cacheVdev)){let u=e.zfsConfig.cacheVdev,h=document.createElement("li"),p="<ul>";u.devices.forEach(t=>{p+=`<li><i class="fas fa-microchip"></i> ${t}</li>`}),p+="</ul>",h.innerHTML=`<i class="fas fa-bolt"></i> ${u.name} <span class="device-status">${u.status}</span>${p}`,d.appendChild(h)}}a("#cpu-usage",e.cpu.usage),s("#cpu-usage + .progress-bar-container .progress-bar",e.cpu.usage),a("#cpu-temp",e.cpu.temp);let f=document.querySelector(".gauge-fill");if(f){let g=e.cpu.tempDeg/100*180;f.style.transform=`rotate(${g}deg)`}a("#net-in",e.net.in),a("#net-out",e.net.out);let m=networkChart.data;m.datasets[0].data.push(parseFloat(e.net.in)||0),m.datasets[0].data.shift(),m.datasets[1].data.push(parseFloat(e.net.out)||0),m.datasets[1].data.shift(),networkChart.update(),a("#disk-mount-point",e.disk.mountPoint),a("#disk-usage-tb",`${e.disk.used} / ${e.disk.total}`),a("#disk-usage-percent",`(${e.disk.percent})`),s("#disk-progress-bar",e.disk.percent)},socket.onclose=function(t){},socket.onerror=function(t){};